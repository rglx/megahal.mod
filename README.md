# MegaHAL, the eggdrop module

Artificially Intelligent conversation with learning capability and psychotic personality.

version 3.7.1, with special changes to the script and very, very minor changes to the module itself by rglx.

## requirements
 - recent version of eggdrop ( https://www.eggheads.org/ ) compiled, running, set up and operational in a channel already
 - the megahal.mod folder (not the main repository, but the subfolder here which should contain the Makefile and the .c and .h files)
 - the training text files of your choosing

## installation
 - stop your bot and make a backup of your userfile, channelfile, and while you're at it, everything else in `~/eggdrop`.
 - add the megahal.mod folder (not the whole repository! just the subdirectory!) to eggdrop's source code directory under `eggdrop-<version>/src/mod/`. inside `eggdrop-<version>/src/mod/megahal.mod/` should be `Makefile`, `megahal.c`, and `megahal.h`.
 - seriously, make that backup.
 - from your source code directory, run `./configure` plus whatever your usual options are (for say, pointing to a specifically compiled tcl version, or compiling in SSL, or something)
 - after that's done, `make config` (or if you used the interactive module setup `make iconfig`) then `make -jX` (where `X` is how many logical cores your machine has) and finally `make install` (if you used the interactive module setup, please make sure to enable compilation and installation of megahal when it asks.)
 - copy `scripts/` and `text/` and `data/` to your eggdrop installation's directory along with their contents
 - edit the configuration section of `scripts/megahal.tcl` and then return here
 - ensure you have proper directory structure (save for what's not been generated by the bot yet) before starting
 - add `source scripts/megahal.tcl` to the bottom of your bot's main configuration, below most everything else.
 - start your bot. it should appear on IRC after generating a brain out of the stock training files.
 - run `!brainsave` in IRC to save your bot's brain. if everything went smoothly this should tell you some information about your bot in addition to making sure the bot's working OK.
 - anywhere you want the bot talking on its own, run `.chanset <#channel> +megahal` in DCC (or the bot's console if you use a tmux session and the `-nt` execution argument)

## technical documentation

most of this i've just gathered over years and years of running an eggdrop bot with this module loaded on an irc channel (or in one instance, a telegram group chat) and just experimenting with the bot or debugging mysterious crashes on startup or what have you, so some of it could be flat out wrong compared to what zev, z0rc, hutch, and the others know as facts.

also, it might kill YOUR brain to know what goes on inside megahal's. you've been warned.

### changes since v3.7 (found on z0rc's github)

 - changed the main binds inside the megahal module to be `pubm` instead of `pub`, which was preventing other AI scripts from hearing things from IRC.
 - overhaul of the `megahal.tcl` script, including:
   - addition of a proper age counter for the brain
   - deeper explanations of the configuration
   - now requiring the script for functionality (as it does lots of things for you)

### directory structure aka "what files do what"

#### partial directory listing of your bot
```
+ eggdrop/ - eggdrop's working/install directory
|
+---+ scripts/ - eggdrop's scripts folder
|   |
|   |---- megahal.tcl - companion script for megahal that adds functionality - see notes below
|   |
|   \---- <your bot's other scripts>
|
|
+---+ modules-<version>/ - eggdrop's modules folder (typically this is symlinked when `make install` is run to modules/ along with the main binary)
|   |
|   |---- megahal.so - the main megahal module itself.
|   |
|   \---- <your bot's other modules>
|
|
+---+ text/ - eggdrop's data directory (for userfiles and whatnot)
|   |
|   +---+ megahal/
|   |   |
|   |   \---+ megahal.trn - main training text file. see notes below
|   |       + megahal.aux - another training file. see notes below
|   |       + megahal.ban - another training file. see notes below
|   |       + megahal.swp - another training file. see notes below
|   |
|   \--- <your bot's motd, help texts, and other things>
|
|
+---+ data/ - eggdrop's data directory (for userfiles and whatnot)
    |
    +---+ megahal/
    |   |
    |   \---+ megahal.brn - the brain itself. little is known of the human brain, and this holds true here as well.
    |       + megahal.dic - holds megahal's entire dictionary of words (for construction of sentences)
    |       + megahal.phr - hold all phrases megahal has encountered (for structural considerations)
    |       + megahal.age - contains a unix timestamp of the brain's first known load or generation date.
    |
    \--- <your userfile, channel file, and some script data>	 
	 


```

#### megahal.tcl

this script was originally developed by a number of other people but it had a little kludge and non-functionality in it so i (rglx) revised it a little as a replacement for `loadmodule megahal` in your config.

## contributors
- original megahal code by Jason Hutchens (1999)
- eggdrop module and initial companion script by Zev ^Baron^ Toledano (up to 3.5), z0rc (3.6), and Nexor (v3.7)
- further minor revisions by rglx (2021)
- for more information plus an enormous changelog look in <../../megahal.mod/megahal.c> in the comments :)
